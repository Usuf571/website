<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω–∫–∞ - –≠–ª–µ–∫—Ç—Ä–æ–ú–∏—Ä</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- –≠—Ñ—Ñ–µ–∫—Ç —Å–Ω–µ–≥–∞ –Ω–∞ –Ω–æ–≤—ã–π –≥–æ–¥ -->
    <div id="snowflakes" class="snowflakes"></div>
    
    <!-- –ö—Ä–∞—Å–∏–≤—ã–π –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–µ–ª–æ–∞–¥–µ—Ä -->
    <div id="preloader">
        <div class="loader"></div>
        <div class="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞<span class="loading-dots"></span></div>
    </div>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo" id="siteLogo">–ê–¥–º–∏–Ω–∫–∞ –≠–ª–µ–∫—Ç—Ä–æ–ú–∏—Ä</div>
                <a href="index.html" class="admin-btn">–ù–∞ —Å–∞–π—Ç</a>
            </div>
        </div>
    </header>

    <main class="container">
        <div id="passwordPrompt" class="auth-form">
            <h2>–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É</h2>
            <input type="password" id="adminPassword" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn" onclick="checkPassword()">–í–æ–π—Ç–∏</button>
            <p id="errorMessage" style="color: red; display: none; margin-top: 10px;"></p>
        </div>

        <div id="adminDashboard" style="display: none;">
            <!-- –ë–æ–∫–æ–≤–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–æ–π -->
            <nav class="sidebar">
                <ul>
                    <li><a href="#" class="active" onclick="switchTab('products'); return false;">üì¶ –¢–æ–≤–∞—Ä—ã</a></li>
                    <li><a href="#" onclick="switchTab('warehouse'); return false;">üè¢ –°–∫–ª–∞–¥</a></li>
                    <li><a href="#" onclick="switchTab('reviews'); return false;">‚≠ê –û—Ç–∑—ã–≤—ã</a></li>
                    <li><a href="#" onclick="switchTab('analytics'); return false;">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                    <li><a href="#" onclick="switchTab('settings'); return false;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
                </ul>
            </nav>

            <!-- –í–∫–ª–∞–¥–∫–∞ –¢–æ–≤–∞—Ä—ã -->
            <div id="productsTab" class="tab-content">
                <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h1>
                <div class="bulk-actions">
                    <input type="checkbox" id="selectAllProducts" onclick="toggleSelectAll('products')"> –í—ã–±—Ä–∞—Ç—å –≤—Å–µ
                    <button class="btn admin-btn-small" onclick="bulkDelete('products')">–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ</button>
                </div>
                <button class="btn" onclick="openAddModal()">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                <button class="btn" onclick="exportProducts()" style="background: #28a745;">–≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                <input type="text" id="adminSearchProducts" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." oninput="debouncedRender('products')">

                <table class="admin-table">
                    <thead>
                        <tr>
                            <th class="checkbox-col"><input type="checkbox" id="headerCheckboxProducts"></th>
                            <th onclick="sortTable('products', 'id')">ID ‚ñ≤</th>
                            <th onclick="sortTable('products', 'name')">–ù–∞–∑–≤–∞–Ω–∏–µ ‚ñ≤</th>
                            <th onclick="sortTable('products', 'price')">–¶–µ–Ω–∞ ‚ñ≤</th>
                            <th onclick="sortTable('products', 'category')">–ö–∞—Ç–µ–≥–æ—Ä–∏—è ‚ñ≤</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="adminTableBodyProducts"></tbody>
                </table>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –û—Ç–∑—ã–≤—ã -->
            <div id="reviewsTab" class="tab-content" style="display: none;">
                <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞–º–∏</h1>
                <div class="bulk-actions">
                    <input type="checkbox" id="selectAllReviews" onclick="toggleSelectAll('reviews')"> –í—ã–±—Ä–∞—Ç—å –≤—Å–µ
                    <button class="btn admin-btn-small" onclick="bulkDelete('reviews')">–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ</button>
                </div>
                <button class="btn" onclick="openReviewModal()">–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                <button class="btn" onclick="exportReviews()" style="background: #28a745;">–≠–∫—Å–ø–æ—Ä—Ç JSON</button>
                <input type="text" id="adminSearchReviews" placeholder="–ü–æ–∏—Å–∫ –æ—Ç–∑—ã–≤–æ–≤..." oninput="debouncedRender('reviews')">

                <table class="admin-table">
                    <thead>
                        <tr>
                            <th class="checkbox-col"><input type="checkbox" id="headerCheckboxReviews"></th>
                            <th onclick="sortTable('reviews', 'id')">ID ‚ñ≤</th>
                            <th onclick="sortTable('reviews', 'author')">–ê–≤—Ç–æ—Ä ‚ñ≤</th>
                            <th onclick="sortTable('reviews', 'rating')">–†–µ–π—Ç–∏–Ω–≥ ‚ñ≤</th>
                            <th onclick="sortTable('reviews', 'date')">–î–∞—Ç–∞ ‚ñ≤</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="adminTableBodyReviews"></tbody>
                </table>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –°–∫–ª–∞–¥ -->
            <div id="warehouseTab" class="tab-content" style="display: none;">
                <h1>üè¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–ª–∞–¥–æ–º</h1>
                <div class="warehouse-controls">
                    <button class="btn" onclick="openWarehouseModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫</button>
                    <button class="btn" onclick="exportWarehouse()" style="background: #28a745;">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn" onclick="exportWarehousePDF()" style="background: #0066cc;">üìÑ –≠–∫—Å–ø–æ—Ä—Ç PDF</button>
                </div>
                
                <div class="warehouse-alerts" id="warehouseAlerts"></div>
                
                <div class="warehouse-stats">
                    <div class="warehouse-stat-card">
                        <h3>üì¶ –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ</h3>
                        <p class="stat-number" id="totalStockItems">0 —à—Ç</p>
                    </div>
                    <div class="warehouse-stat-card">
                        <h3>‚ö†Ô∏è –¢–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∏—Å—Ö–æ–¥–µ</h3>
                        <p class="stat-number" id="lowStockItems">0 —à—Ç</p>
                    </div>
                    <div class="warehouse-stat-card">
                        <h3>‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏</h3>
                        <p class="stat-number" id="outOfStockItems">0 —à—Ç</p>
                    </div>
                    <div class="warehouse-stat-card">
                        <h3>üíµ –°—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤</h3>
                        <p class="stat-number" id="totalStockValue">0 —Å–æ–º</p>
                    </div>
                </div>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π</h2>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–¢–æ–≤–∞—Ä</th>
                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th>–¶–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="warehouseHistoryTable"></tbody>
                </table>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">–¢–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏</h2>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>–¢–æ–≤–∞—Ä</th>
                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                            <th>–ú–∏–Ω–∏–º—É–º</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="warehouseStockTable"></tbody>
                </table>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
            <div id="analyticsTab" class="tab-content" style="display: none;">
                <h1>üìä –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
                
                <div class="analytics-controls">
                    <select id="analyticsDateRange" onchange="updateAnalytics()">
                        <option value="week">–ó–∞ –Ω–µ–¥–µ–ª—é</option>
                        <option value="month" selected>–ó–∞ –º–µ—Å—è—Ü</option>
                        <option value="year">–ó–∞ –≥–æ–¥</option>
                        <option value="all">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</option>
                    </select>
                    <button class="btn" onclick="exportAnalyticsCSV()" style="background: #28a745;">üìä –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
                    <button class="btn" onclick="exportAnalyticsPDF()" style="background: #0066cc;">üìÑ –≠–∫—Å–ø–æ—Ä—Ç PDF</button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>üì¶ –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                        <p class="stat-number" id="totalProducts">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>üí∞ –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞</h3>
                        <p class="stat-number" id="avgPrice">0 —Å–æ–º</p>
                    </div>
                    <div class="stat-card">
                        <h3>‚≠ê –û—Ç–∑—ã–≤–æ–≤</h3>
                        <p class="stat-number" id="totalReviews">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</h3>
                        <p class="stat-number" id="totalViews">0</p>
                    </div>
                </div>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">üìà –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–¥–∞–∂ –ø–æ –¥–Ω—è–º</h2>
                <div id="salesChart" style="height: 300px; margin-bottom: 2rem; background: var(--card-bg); border-radius: 10px; padding: 1rem;"></div>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">üîù –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</h2>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th>
                            <th>–ù—Ä–∞–≤–∏—Ç—Å—è</th>
                            <th>–¢—Ä–µ–Ω–¥</th>
                        </tr>
                    </thead>
                    <tbody id="topProductsTable"></tbody>
                </table>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">üö¶ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞</h2>
                <div class="traffic-stats" id="trafficStats"></div>

                <h2 style="margin-top: 2rem; margin-bottom: 1rem;">üìä –¢–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h2>
                <div id="categoryStats" style="margin: 1rem 0;"></div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div id="settingsTab" class="tab-content" style="display: none;">
                <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞</h1>
                <button class="btn" onclick="openSettingsModal()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <div id="settingsDisplay" style="margin-top: 2rem; padding: 1rem; background: #f8f9ff; border-radius: 10px;">
                    <!-- –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </main>

    <!-- –ú–æ–¥–∞–ª –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ) -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddModal()">&times;</span>
            <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>
            <form id="productForm">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ (—Å–æ–º)</label>
                    <input type="number" id="productPrice" min="0" required>
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="productDesc" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <div class="image-upload-container">
                        <div class="image-preview" id="imagePreview" style="display: none;">
                            <img id="previewImg" src="" alt="Preview" style="max-width: 100%; height: auto; border-radius: 10px; margin-bottom: 1rem;">
                            <button type="button" class="btn" style="background: #6c757d; width: 100%; margin-bottom: 0.5rem;" onclick="clearImagePreview()">–û—á–∏—Å—Ç–∏—Ç—å</button>
                        </div>
                        <div class="upload-options">
                            <div class="form-group">
                                <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</label>
                                <input type="file" id="productImageFile" accept="image/*" onchange="handleImageUpload(event)">
                            </div>
                            <div style="text-align: center; margin: 1rem 0; color: #999;">–∏–ª–∏</div>
                            <div class="form-group">
                                <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                                <input type="url" id="productImage" placeholder="https://example.com/image.jpg">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="productCategory" required>
                        <option value="phones">–¢–µ–ª–µ—Ñ–æ–Ω—ã</option>
                        <option value="tablets">–ü–ª–∞–Ω—à–µ—Ç—ã</option>
                        <option value="laptops">–ù–æ—É—Ç–±—É–∫–∏</option>
                    </select>
                </div>
                <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ -->
    <div id="reviewModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeReviewModal()">&times;</span>
            <h3 id="reviewModalTitle">–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
            <form id="reviewForm">
                <input type="hidden" id="editReviewId">
                <div class="form-group">
                    <label>–ê–≤—Ç–æ—Ä</label>
                    <input type="text" id="reviewAuthor" required>
                </div>
                <div class="form-group">
                    <label>–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞</label>
                    <textarea id="reviewText" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>–†–µ–π—Ç–∏–Ω–≥ (1-5)</label>
                    <select id="reviewRating" required>
                        <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
                        <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
                        <option value="3">3 –∑–≤–µ–∑–¥—ã</option>
                        <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
                        <option value="5">5 –∑–≤—ë–∑–¥</option>
                    </select>
                </div>
                <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSettingsModal()">&times;</span>
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∞–π—Ç–∞</h3>
            <form id="settingsForm">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞</label>
                    <input type="text" id="siteName" required>
                </div>
                <div class="form-group">
                    <label>–ê–¥—Ä–µ—Å –º–∞–≥–∞–∑–∏–Ω–∞ (–¥–ª—è –∫–∞—Ä—Ç—ã)</label>
                    <input type="text" id="storeAddress" placeholder="e.g., Moscow, Russia" required>
                </div>
                <div class="form-group">
                    <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∫–∏</label>
                    <input type="password" id="newPassword" required>
                </div>
                <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª –¥–ª—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ -->
    <div id="warehouseModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeWarehouseModal()">&times;</span>
            <h3 id="warehouseModalTitle">–î–æ–±–∞–≤–∏—Ç—å/–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞—Ç–æ–∫</h3>
            <form id="warehouseForm">
                <input type="hidden" id="warehouseEditId">
                <div class="form-group">
                    <label>–¢–æ–≤–∞—Ä</label>
                    <select id="warehouseProductId" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (—à—Ç)</label>
                    <input type="number" id="warehouseQuantity" min="0" required>
                </div>
                <div class="form-group">
                    <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ (—à—Ç)</label>
                    <input type="number" id="warehouseMinimum" min="1" value="5" required>
                </div>
                <div class="form-group">
                    <label>–¶–µ–Ω–∞ –∑–∞–∫—É–ø–∫–∏ (—Å–æ–º)</label>
                    <input type="number" id="warehouseCostPrice" min="0" required>
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</label>
                    <input type="date" id="warehouseDate" required>
                </div>
                <div class="form-group">
                    <label>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
                    <textarea id="warehouseNote" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"></textarea>
                </div>
                <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>